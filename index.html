<html>

<head>
    <title>Searchmetrics API Connector for Tableau</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link href="style.css" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" type="text/javascript"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" crossorigin="anonymous"></script>

    <script src="https://connectors.tableau.com/libs/tableauwdc-2.3.latest.js" type="text/javascript"></script>
    <script src="CollectApiData.js" type="text/javascript"></script>
    <script src="ProjectOrganicGetListRankingsFilter.js" type="text/javascript"></script>
    <script src="ResearchOrganicGetListRankingsDomain.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListRankingsKeyword.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListRankingsKeywordLongtail.js" type="text/javascript"></script>
	<script src="ResearchLinksGetListBacklinks.js" type="text/javascript"></script>
	<script src="ResearchContentGetListUrlKeywordRankings.js" type="text/javascript"></script>
	<script src="ResearchKeywordsGetListLosers.js" type="text/javascript"></script>
	<script src="ResearchKeywordsGetListWinners.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListSeoVisibilityTop100Losers.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListSeoVisibilityTop100Winners.js" type="text/javascript"></script>
	<script src="ResearchContentGetListTopUrls.js" type="text/javascript"></script>
	<script src="ResearchContentGetListLoserUrls.js" type="text/javascript"></script>
	<script src="ResearchContentGetListWinnerUrls.js" type="text/javascript"></script>
	<script src="ResearchContentGetListCompetitorUrls.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListCompetitors.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListSerpSpread.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListSubdomains.js" type="text/javascript"></script>
	<script src="ResearchKeywordsGetListSimilarKeywords.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListIndustrySpread.js" type="text/javascript"></script>
	<script src="ResearchLinksGetListLinkedPages.js" type="text/javascript"></script>
	<script src="ResearchLinksGetListLinktext.js" type="text/javascript"></script>
	<script src="ResearchLinksGetValueLinkRank.js" type="text/javascript"></script>
	<script src="ResearchUniversalGetListRankingsDomain.js" type="text/javascript"></script>
	<script src="ProjectOrganicGetListBenchmarkRankings.js" type="text/javascript"></script>
	<script src="ProjectOrganicGetListLosers.js" type="text/javascript"></script>
	<script src="ProjectOrganicGetListWinners.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetValueSeoVisibility.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetValueSeoVisibilityWorld.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetValueSeoRank.js" type="text/javascript"></script>
	<script src="ResearchUniversalGetListVisibility.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListSeoVisibilityCountry.js" type="text/javascript"></script>
	<script src="ResearchKeywordsGetListKeywordinfo.js" type="text/javascript"></script>
	<script src="ResearchSocialGetListTopUrls.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListSeoVisibilityHistoric.js" type="text/javascript"></script>
	<script src="ResearchOrganicGetListRankingsDomainHistoric.js" type="text/javascript"></script>

    <script type="text/javascript">
	var mapObj = {
		ResearchOrganicGetListRankingsKeyword: {
			show: [
				'keyword',
				'countrycode',
				'limit',
				'offset'
			]
		},
		ResearchOrganicGetListIndustrySpread: {
			show: [
				'countrycode',
				'url'
				]
		},
        ResearchOrganicGetListRankingsDomain: {
			show: [
				'url',
				'countrycode',
				'limit',
				'offset'
						
			]
		},
				
		ResearchOrganicGetListRankingsDomainHistoric:{
			show:[
			'countrycode',
			'date',
			'url',
			'currency', 			
			'limit',	
			'offset'
			
			]
		
		},
       
	   ResearchOrganicGetListRankingsKeywordLongtail: {
			show: [
				'keyword',
				'countrycode',
				'limit',
				'offset'			
				]
			
		},
		
		ResearchOrganicGetListSeoVisibilityCountry: {
			show: [
				'url'
				]
		}, 
			
		ResearchOrganicGetListSeoVisibilityHistoric: {
			show: [
				'countrycode',
				'date_from',
				'date_to',
				'url'
				]
		},
		
		ResearchOrganicGetListSeoVisibilityTop100Losers: {
			show:[
				'countrycode'
				]
		},
		
		ResearchOrganicGetListSeoVisibilityTop100Winners: {
			show:[
				'countrycode'
				]
		},
		
		ResearchOrganicGetListSerpSpread: {
			show: [
				'url',
				'countrycode'
				]
		},
		
		ResearchOrganicGetListSubdomains: {
			show: [
				'url',
				'countrycode',
				'limit',
				'offset'
				]
		},
		
		ResearchOrganicGetValueSeoRank: {
			show: [
				'url',
				'countrycode'
				]
		},
		ResearchOrganicGetValueSeoVisibility: {
			show: [
				'countrycode',
				'url'
				]
		},
		
		ResearchOrganicGetValueSeoVisibilityWorld: {
			show: [
				'url'
				]
		
		},
		
		
		ResearchKeywordsGetListKeywordinfo: {
			show: [
				'keyword',
				'countrycode',
				'currency'
				
				]
		},
		
		ResearchKeywordsGetListLosers: {
			show: [
				'countrycode',
				'url',
				'limit',
				'offset'
				]
		},	
		ResearchKeywordsGetListSimilarKeywords: {
			show: [
				'keyword',
				'countrycode'
				]
		},
		
		ResearchKeywordsGetListWinners: {
			show: [
				'countrycode',
				'url',
				'limit',
				'offset'
				]
		},
		
		ResearchLinksGetListBacklinks: {
			show:[
				'url',
				'limit',
				'offset'
				]
		
		},	
		
		
		ResearchLinksGetListLinkedPages: {
			show: [
				'url',
				'limit',
				'offset'
				]
			
		},
		ResearchLinksGetListLinktext: {
			show: [
				'url',
				'limit',
				'offset'				
				]
		
		},
		ResearchLinksGetValueLinkRank: {
			show: [
				'competitors',
				'countrycode',
				'url'
				]
		},
		ResearchSocialGetListTopUrls: {
			show: [	
				'url',
				'limit',
				'offset'
				]
		}
		,
		
		ResearchUniversalGetListRankingsDomain: {
			show:[
				'countrycode',
				'url',
				'limit',
				'offset'
				]
		},
					
		ResearchUniversalGetListVisibility: {
			show: [
				'countrycode',
				'url'
				]
		},
		ResearchOrganicGetListCompetitors: {
			show: [
				'url',
				'countrycode',
				'currency',
				'limit',
				'offset'
				]
		},
		ResearchContentGetListCompetitorUrls: {
			show: [
				'url',
				'countrycode',
				'limit',
				'offset'
				]
		},
		ResearchContentGetListLoserUrls: {
			show:[
				'countrycode',
				'domain',
				'limit',
				'offset'
				]
		},
		ResearchContentGetListTopUrls: {
			show: [
				'domain',
				'countrycode',
				'limit',
				'offset'
				]
		},
				
		ResearchContentGetListUrlKeywordRankings: {
			show:[
				'countrycode',
				'url',
				'limit',
				'offset'
				]
		
		},
					
		ResearchContentGetListWinnerUrls: {
			show:[
				'countrycode',
				'domain',
				'limit',
				'offset'
				]
		},

		ProjectOrganicGetListRankingsFilter: {
			show: [
				'url',
				'se_id',
				'project_id'				
			]
		},
		
		ProjectOrganicGetListBenchmarkRankings: {
			show:[
				'project_id',
				'se_id',
				'urls'
				]
		},
		
		ProjectOrganicGetListLosers: {
			show:[
				'project_id',
				'se_id',
				'urls',
				'date_from',
				'date_to',
				'limit',
				'offset'
				]
		},
		
		ProjectOrganicGetListWinners: {
			show: [
				'project_id',
				'se_id',
				'urls',
				'date_from',
				'date_to',
				'limit',
				'offset'
				]
		},
	/*	ResearchOrganicGetListRankingsKeywordHistoric:{
			show:[
			'countrycode',
			'date',
			'keyword',
			'limit',
			'offset'
			]
		
		}*/
		

	};
	</script>

   
</head>

<body>
    <div class="container container-table">
            <div>
                <h1>Searchmetrics API Connector for Tableau</h1>
            </div>

            <form method="post" action="ProjectOrganicGetListRankingsFilter.js">
				<div class="block">
					<label>Token:</label>
					<input id="access_token" name="access_token" type="text" />
				</div>
					<label>Report: </label> 
				<select name="apicall" id="apicall"></select> 
				
				<div title="Either a domain or subdomain.&#10;Format: domain.tld, subdomain.domain.tld">
					<label>URL: </label> 
					<input id="url" name="url" type="text" />
				</div>
				
				<div title="Domains within the project that should be queried. Several domains must be separated with a comma without blank.&#10; Please use the exact name that is used within the project. &#10;E.g &quot;www.searchmetrics.com&quot; instead of &quot;searchmetrics.com&quot;.&#10;Format: domain.tld, subdomain.domain.tld">
					<label>URLs: </label> 
					<input id="urls" name="urls" type="text" />
				</div>
				
				<div title="Competitors of the given domain, several domains must be separated with a comma without blank.">
					<label>Competitors: </label> 
					<input id="competitors" name="competitors" type="text"  />
				</div>
				
				<div title="Either a domain or subdomain.&#10;Format: domain.tld, subdomain.domain.tld">
					<label>Domain: </label> 
					<input id="domain" name="domain" type="text" />
				</div>
				
				<div title="Keyword for which info should be queried.&#10;Format: string">
					<label>Keyword: </label> 
					<input id="keyword" name="keyword" type="text" />
				</div>
				
				<div title="A two letter country code as specified in ISO 3166-1&#10;Format: US, GB, DE etc">
					<label>Country Code: </label>
					<select name="countrycode" id="countrycode">
					<option value="AR">AR</option>
					<option value="AU">AU</option>
					<option value="AT">AT</option>
					<option value="BE">BE</option>
					<option value="BR">BR</option>
					<option value="CA">CA</option>
					<option value="cn">CN</option>
					<option value="CO">CO</option>
					<option value="DK">DK</option>
					<option value="FI">FI</option>
					<option value="FR">FR</option>
					<option value="DE">DE</option>
					<option value="HK">HK</option>
					<option value="IE">IE</option>
					<option value="IN">IN</option>
					<option value="IT">IT</option>
					<option value="JP">JP</option>
					<option value="MX">MX</option>
					<option value="NL">NL</option>
					<option value="NO">NO</option>
					<option value="PL">PL</option>
					<option value="RU">RU</option>
					<option value="SG">SG</option>
					<option value="ZA">ZA</option>
					<option value="ES">ES</option>
					<option value="SE">SE</option>
					<option value="CH">CH</option>
					<option value="TR">TR</option>
					<option value="US">US</option>
					<option value="GB">UK</option>		
					</select>
					<!--<input id="countrycode" name="countrycode" type="text" value="DE" />-->
				</div>
				
				<div title="ID of the search engine that should be queried. A complete list of IDs can be found http://api.searchmetrics.com/api-calls/searchengines.&#10;Please make sure your project includes the se_id.&#10;Format: integer">
					<label>Search Engine: </label>
					<input id="se_id" name="se_id" type="text" />
				</div>
				
				<div title="ID of the project that should be queried.&#10;The ID can be found in the URL when viewing the project in the Searchmetrics Suite.&#10;Format: Integer">
					<label>Project ID: </label>
					<input id="project_id" name="project_id" type="text"  />
				</div>
				
				<div title="Date. &#10;Format: YYYYMM">
					<label>Date: </label>
					<input id="year_month" name="year_month" type="text" />
				</div>
				<div title="Date. &#10;Format: YYYYMM">
					<label>Date: </label>
					<input id="date" name="date" type="text" />
				</div>
									
				<div title="Filter: Lowest ranking of keywords that should be considered in the count.&#10;E.g. if you want to count all keywords starting from the position 4 (meaning 4,5,6 etc.) this parameter has to be set to &quot;Format: 1,2,3 etc.">
					<label>Position from: </label>
					<input id="position_from " name="position_from " type="text" />
				</div>
				
				<div title="Filter: Highest ranking of keywords that should be considered in the count.&#10;E.g. if you want to count all keywords up to position 3 ( resulting in all keywords with a SERP of 1, 2 or 3) this parameter has to be set to &quot;Format: 2,3,4 etc.">
					<label>Position to: </label>
					<input id="position_to " name="position_to " type="text" />
				</div>
				
				<div title="Either a domain or subdomain.&#10;Format: domain.tld, subdomain.domain.tld">
					<label>URL 1: </label>
					<input id="url_1" name="url_1" type="text" />
				</div>
				
				<div title="Either a domain or subdomain.&#10;Format: domain.tld, subdomain.domain.tld">
					<label>URL 2:</label>
					<input id="url_2" name="url_2" type="text" />
				</div>
				
				<div title="Limit for the number of result rows.&#10;Permitted values are 10, 25, 50, 100, 250.&#10;Default is 10.&#10;Format: integer)">
					<label>Limit:</label>
					<input id="limit" name="limit" type="text" value="10" />
				</div>
				
				<div title="Offset for result set&#10;Must be a multiple of allowed values for the parameter &quot;limit&quot; &#10;Default is 0.&#10;Format: integer">
					<label>Offset:</label>
					<input id="offset" name="offset" type="text" value="0"/>
				</div>
				
				<div title="Currency code as specified in ISO 4217. Default is &quot;EUR&quot;.&#10;Format: EUR, USD etc.">
					<label>Currency :</label>
					<input id="currency " name="currency " type="text" value="EUR" />
				</div>
				
				<div title="Filter: Lowest monthly search volume in Google for returned keywords.&#10;E.g. if you want all keywords with a minimum estimated search volume of 300 this parameter has to be set to &quot;300&quot;.&#10;Format: integer">
					<label>Search volume monthly from :</label>
					<input id="search_volume_monthly_from" name="search_volume_monthly_from" type="text" />
				</div>
				
				<div title="Filter: Highest estimated monthly search volume for returned keywords.&#10;E.g. if you want all keywords with a maximum estimated monthly search volume of 1000 this parameter has to be set to &quot;1000&quot;.&#10;Format: integer">
					<label>Search volume monthly to:</label>
					<input id="search_volume_monthly_to" name="search_volume_monthly_from" type="text" />
				</div>
				
				<div title="Filter: Lowest estimated traffic for returned keywords.&#10;E.g. if you want all keywords with a minimum estimated traffic of 300 visitors this parameter has to be set to &quot;300&quot;.&#10;Format: integer">
					<label>Traffic monthly from:</label>
					<input id="traffic_monthly_from" name="traffic_monthly_from" type="text" />
				</div>
				
				<div title="Filter: Highest estimated traffic for returned keywords.&#10;E.g. if you want all keywords with a maximum estimated traffic of 1000 visitors this parameter has to be set to &quot;1000&quot;.&#10;Format: integer">
					<label>Traffic monthly to:</label>
					<input id="traffic_monthly_to" name="traffic_monthly_to" type="text" />
				</div title="">
				
				<div title="Start date from which the SEO Visibility should be queried.&#10;Format: YYYYMMDD">
					<label>Date from:</label>
					<input id="date_from" name="date_from" type="text" value="20170101" />
				</div>
				
				<div title="End date to which the SEO Visibility should be queried.&#10;Format: YYYYMMDD">
					<label>Date to:</label>
					<input id="date_to" name="date_to" type="text" value="20170201" />
				</div>
				
				<div title="Date.&#10;Format: YYYYMM">
					<label>Year month:</label>
					<input id="year_month" name="year_month" type="text" />
				</div>
				
				<div title="Filter: Lowest estimated CPC for returned keywords.&#10;E.g. if you want all keywords with a minimum estimated CPC of 1€ visitors this parameter has to be set to &quot;1&quot;.&#10;Format: integer">
					<label>CPC from:</label>
					<input id="cpc_from" name="cpc_from" type="text" />
				</div>
				
				<div title="Filter: Highest estimated CPC for returned keywords.&#10;E.g. if you want all keywords with a maximum estimated CPC of 2 this parameter has to be set to &quot;2&quot;.&#10;Format: integer">
					<label>CPC to:</label>
					<input id="cpc_to" name="cpc_to" type="text" />
				</div>
				
				<div title="Filter: Lowest change in position of a keyword that should be returned.&#10;E.g. if you want all keywords with a change of 4 or less positions this parameter has to be set to &quot;-4&quot;.&#10;Format: integer">
					<label>Delta position from:</label>
					<input id="delta_position_from" name="delta_position_from" type="text" />
				</div>
				
				<div title="Filter: Highest change in position of a keyword that should be returned.&#10;E.g. if you want all keywords with a change of 10 or more positions this parameter has to be set to &quot;-10&quot;.&#10;Format: integer">
					<label>Delta position to:</label>
					<input id="delta_position_to" name="delta_position_to" type="text" />
				</div>
				
				<div title="Filter: Lowest change in traffic of a keyword that should be returned.&#10;E.g. if you want all keywords with a change of 50 or less visitors this parameter has to be set to &quot;-50&quot;.&#10;Format: integer">
					<label>Delta traffic from:</label>
					<input id="delta_traffic_from" name="delta_traffic_from" type="text" />
				</div>
				
				<div title="Filter: Highest change in traffic of a keyword that should be returned.&#10;E.g. if you want all keywords with a change of 1000 or more visitors this parameter has to be set to &quot;-1000&quot;.&#10;Format: integer">
					<label>Delta traffic to:</label>
					<input id="delta_traffic_to" name="delta_traffic_to" type="text" />
				</div>
            </form>



        <div class="row vertical-center-row">
            <div class="text-center col-md-4 col-md-offset-4">
                <button type="button" id="submitButton" class="btn btn-success" style="margin: 10px;" onclick="datacollect()">Get your Searchmetrics Data!</button>
            </div>
        </div>
    </div>
</body>              
<script>
<!--Javascript für die Option-->
$( document ).ready(function() {
	hideInputs();

	Object.keys(mapObj).map(function(el){
		$('#apicall').append(
			$('<option/>').text(el)
		);
	});
	
	$('#apicall').on('change', function(){selectOption(this)});
	selectOption('#apicall');
});


function hideInputs(){
	$('input').not('#access_token').prop('disabled', true).closest('div').hide();
	$('select').not('#apicall').prop('disabled', true).closest('div').hide();
}

function selectOption(el){
	var item = $(el).val();
	var action = $(el).children('[value="' + item + '"]').text();
	$(el).closest('form').attr('action', action + '.js');
	hideInputs();
	$('#' + mapObj[item].show.join(',#')).prop('disabled', false).closest('div').show();
}
</script>
</html>
